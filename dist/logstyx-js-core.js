var X=Object.defineProperty;var L=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var w=(e,r,s)=>r in e?X(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,T=(e,r)=>{for(var s in r||(r={}))k.call(r,s)&&w(e,s,r[s]);if(L)for(var s of L(r))q.call(r,s)&&w(e,s,r[s]);return e};var x=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports);var b=(e,r,s)=>new Promise((o,g)=>{var y=c=>{try{f(s.next(c))}catch(l){g(l)}},n=c=>{try{f(s.throw(c))}catch(l){g(l)}},f=c=>c.done?o(c.value):Promise.resolve(c.value).then(y,n);f((s=s.apply(e,r)).next())});var I=x(j=>{j.sanitizeObject=e=>Object.entries(e).reduce((r,[s,o])=>(o!=null&&o!==""&&!(Array.isArray(o)&&o.length===0)&&!(typeof o=="object"&&!Array.isArray(o)&&Object.keys(o).length===0&&o.constructor===Object)&&(r[s]=o),r),{});j.normalizeArgs=e=>{var g,y;let o=(n,f=0,c=new WeakSet)=>{if(n===null||typeof n!="object")return typeof n=="string"&&n.length>500?n.substring(0,500)+"... (truncated)":n;if(f>=2)return"[Max depth reached]";if(c.has(n))return"[Circular]";if(c.add(n),Array.isArray(n))return n.slice(0,10).map(i=>o(i,f+1,c));let l={};for(let i in n)i.startsWith("_")||Object.prototype.hasOwnProperty.call(n,i)&&typeof n[i]!="function"&&(l[i]=o(n[i],f+1,c));return l};if(e instanceof Error){let n={title:(y=e.name)!=null?y:(g=e==null?void 0:e.constructor)==null?void 0:g.name,message:e.message,stack:e.stack||null},f=new WeakSet;return Object.keys(e).forEach(c=>{!n[c]&&typeof e[c]!="function"&&(n[c]=o(e[c],0,f))}),n}return e==null?{message:String(e)}:Array.isArray(e)?{message:JSON.stringify(e)}:typeof e=="object"?e:{message:String(e)}}});var M=x(_=>{var{sanitizeObject:S,normalizeArgs:z}=I();_.useLogstyx=e=>{let{projectId:r,apiKey:s,appid:o,endpoint:g,device:y,sendFunc:n,signatureFunc:f,maxLogInQueue:c=12,onError:l}=e;typeof n!="function"&&(n=fetch);let i=[],A=!1,p=0,h=null,d={appid:o};function R(t){d=T(T({},d),t)}function G(t){if(Array.isArray(t))for(let a of t)delete d[a];else d={}}function E(t,a){if(typeof l=="function")try{l(t,a)}catch(C){}}function N(){if(!(A||h)&&i.length>0){let t=Math.min(1e3*Math.pow(2,p),3e4);h=setTimeout(P,t)}}function P(){return b(this,null,function*(){if(h&&(clearTimeout(h),h=null),!(A||i.length===0)){A=!0;try{let{level:t,data:a}=i[0];yield u(t,a,!0),i.shift(),p=0}catch(t){p++;let a=i.shift();i.push(a),E(t,{level:a.level,queueLength:i.length,consecutiveFailures:p})}finally{A=!1}N()}})}function u(B){return b(this,arguments,function*(t,a={},C=!1){try{let O=S({level:t,projectId:r,appid:o,device:y,context:S(d),data:S(z(a))}),m={"Content-Type":"application/json"};if(typeof f=="function"){let{timestamp:H,signature:Q}=f(r,s,O);m.signature=Q,m.timestamp=H}return yield n(g,{method:"POST",body:JSON.stringify(O),headers:m})}catch(O){if(C)throw O;if(i.length>=c){let m=i.shift();E(new Error("Queue full, dropping oldest log"),{dropped:m})}i.push({level:t,data:a}),N()}})}return{info:t=>u("INFO",t),warning:t=>u("WARNING",t),error:t=>u("ERROR",t),critical:t=>u("CRITICAL",t),success:t=>u("SUCCESS",t),send:u,setContext:R,clearContext:G,getQueueLength:()=>i.length}}});var{useLogstyx:F}=M();module.exports=e=>F(e);
